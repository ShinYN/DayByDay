# Resource 추상화

리소스의 구현체
- UriResource
- ClassPathResource
- FileSystemResource
- ServletContextResource

Resource의 타입은 location 문자열과 ApplicationConext의 타입에 따라 결정된다
- ClassPathXmlApplicationContext -> ClassPathResource
- FileSystemXmlApplicationContext -> FileSystemResource

ApplicationConext의 타입에 상관없이 접두어를 통해서 컨트롤 가능하다
- classpath:
- file////



# Vildation 추상화
org.springframework.validation.Validator

### Validation를 구현해서 테스트
Validator 클래스
- 코드
    ~~~java
    public class EventValidator implements Validator {

        @Override
        public boolean supports(Class<?> clazz) {
            return Event.class.equals(clazz);
        }

        @Override
        public void validate(Object target, Errors errors) {
            ValidationUtils.rejectIfEmptyOrWhitespace(errors, "title", "notempty", "Empty title is not allowed");
        }
    }
    ~~~

검증
- 코드
   ~~~java
   Event event = new Event();
    EventValidator eventValidator = new EventValidator();
    Errors errors = new BeanPropertyBindingResult(event, "event");

    eventValidator.validate(event, errors);

    System.out.println(errors.hasErrors());

    errors.getAllErrors().forEach(e -> {
        System.out.println("=======error code=======");
        Arrays.stream(e.getCodes()).forEach(System.out::println);
        System.out.println(e.getDefaultMessage());
    });
   ~~~


### 스프링부트 2.0.5 이상 버전
기본 제공되는 Annotation 을 이용해서 Validation이 가능하다면, 별도의 Validator를 만들지 않고 기존 Validator를 의존성 주입받아서 사용할 수 있다
- org.springframework.validation.beanvalidation.LocalValidatorFactoryBean

대상 클래스 
- 코드
    ~~~java
    @NotEmpty
    String title;

    @NotNull @Min(0)
    Integer limit;

    @Email
    String email;
    ~~~


검증 코드
- 코드
    ~~~java
    @Autowired
    Validator validator;

    @Override
    public void run(ApplicationArguments args) throws Exception {

        System.out.println(validator.getClass());

        Event event = new Event();
        event.setLimit(-1);
        event.setEmail("test");
        Errors errors = new BeanPropertyBindingResult(event, "event");

        validator.validate(event, errors);

        System.out.println(errors.hasErrors());

        errors.getAllErrors().forEach(e -> {
            System.out.println("=======error code=======");
            Arrays.stream(e.getCodes()).forEach(System.out::println);
            System.out.println(e.getDefaultMessage());
        });
    }
    ~~~
