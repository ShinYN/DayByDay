# 2. 윈도우 기본 개념 이해하기
## 5가지 기본 요소
### 1. 유저 모드와 커널 모드
유저모드
- 사용자가 이용하는 영역
- 운영체제의 시스템 영역을 제외한 데이터 영역에 접근이 가능
- 하드웨어에 엑세스를 할 수 없다

커널 모드
- 윈도우가 관리하는 시스템 영역
- 커널과 디바이스 드라이버들만 사용
- 모든 시스템 자원에 접근이 가능하다

Ring 권한
- Ring 0: 커널 모드. 최고권한
- Ring 3: 유저 모드. 하드웨러를 이용하기 위한 권한을 요청하고 올바른 요청인지 확인한 후 사용이 가능

### 2. 프로세스
정의
- 하나의 프로그램을 실행하기 위한 자원의 집합

특징
- 크기: 메모리 > 프로세스 > 코드, 리소스 > 스레드가 실행
- PID: 프로세스 ID. 프로세스의 고유 식별 번호

__프로세스 익스프롤러__
- 다운로드: [Link](https://docs.microsoft.com/ko-kr/sysinternals/downloads/process-explorer)
- 프로세스 정보에 대해서 더 자세하기 확인이 가능하다
- 서비스 프로세스
   - 윈도우에서 사용자 화면이 필요 없이 실행되는 프로세스
   - __svchost__
      - 서비스를 운영해주는 프로세스
      - 윈도우에서 기본적으로 제공하는 기능들을 관리하는 프로세스
- 옵션
   - Lowel Pane View: Handle이나 DLL의 정보에 대해서 추가 표시

### 3. 스레드
정의
- 프로그램의 실행 코드를 커널에서 처리하는 역할
- CPU에서 수행되기 때문에 CPU 상태 정보를 가지고 있으며, CPU를 나누어 쓰기 위한 스케줄링과 관련된 정보를 가지고 있다
- TID라는 고유 아이디를 가지고 있다

확인
- `프로세스 익스프롤러`에서 Properties -> Thread 에서 확인이 가능하다

### 4. 가상 메모리
정의
- 물리 메모리와 디스크를 이용한 메모리를 모두 통합하여 관리해서 프로세스들이 메모리를 의식하지 않고 사용할 수 있도록 도와주는 역할
- 실제로 저장된 공간이 떨어져 있더라도 프로세스 입장에서는 같은 저장 공간에 저장되어 있는 형태로 관리해주는 것

메모리 관리자
- 프로세스는 메모리 관리자를 통해서 메모리를 이용
- MAP이라는 프로세스별로 연결된 저장 위치 정보를 가지고 있어서 이를 통해 현재 프로세스가 사용하는 물리적 메모리 혹은 디스크 저장 위치를 관리하게 된다

특징
- 모든 프로세스를 메모리를 최대 각각 128TB의 용량으로 가질 수 있다
- 0x000000000000 ~ 0x00007FFFFFFF (커널에서 0xFFFF80000000 ~ 0xFFFFFFFFFFFF)

작업 관리자
- 메모리(활성 개인 작업 집합): 실제 물리적 메모리. 공유되지 않는 공간
- 커밋 크기(Commit Size): 운영체제에서 프로세스에 예약한 가상 메모리 양
   - 프로세스 익스플로러에서는 `Private Byte`로 표시

VMMap
- 메모리 분석 도구
- 다운로드: [Link](https://docs.microsoft.com/ko-kr/sysinternals/downloads/vmmap)
- 탭 설명
   - Committed: 물리와 가상이 포함된 전체 메모리 크기

### 5. 객체와 핸들
객체
- 하나의 기능을 위해 사용되는 묶음, 구조체들을 객체. (프로세스도 스레드도 객체)
- 윈도우 객체는 커널 메모리 공간에 위치
   - 커널 메모리라고 부르는 이유는 프로세스들이 직접 접근하지 못하고 윈도우의 관리하에 접근하도록 되어 있기 때문이다
- 객체에 접근하기 위해서는 조정자가 있어야 하는데 이 조정자가 바로 핸들(Handle)이다

핸들
- 핸들은 객체를 사용하기 위해 존재한다
- 유저모드에서는 핸들을 통해서 객체에 접근해야 한다
- 커널모드에서(동작하는 프로그램은) 바로 객체에 접근 가능하다
- 예: 유저모드 프로그램이 파일에 접근해야 한다면
   1. 접근하고자 하는 파일의 핸들을 통해서 윈도우에게 해당 파일에 접근하겠다고 요청을 보낸다
   2. 윈도우에서 요청을 확인
   3. 시스템 드라이버인 디스크 드라이버를 통해서 파일 객체에 접근하여 요청을 처리
- 핸들을 종료해서 특정 기능을 중단시키는 것이 가능하다
   - 예를 들어서 뮤텍스 관련 핸들을 종료하면 동일 프로그램이 2개가 실행될 수 있도록 처리도 할 수 있다

핸들 정보 확인 -> 프로세스 익스프롤러에서 확인 가능
- Handle: 현재 프로세스의 핸들 정보가 위치한 주소
   - 모든 프로세스는 핸들 테이블이라는 자신이 사용하는 핸들의 주소를 따로 가지고 있다
- Object Address: 객체가 실제로 저장된 메모리 주소


뮤텍스와 세마포어
- 자원의 접근을 허용하기 위해 사용되는 방법 중 하나
- 뮤텍스
   - 공유 자원에 접근할 수 있는 키를 접근하고자 하는 주체가 가지고 갔다가 다 사용했을 때 키를 돌려 놓는 방식
   - 단일 접근 제어에 유리
- 세마포어
   - 관리자가 숫자를 카운트하여 현재 공유 자원이 있는지를 카운트하는 방식
   - 다중 접근 제어에 유용


## 멀티 프로세싱
SMP(Symmetric multiprocessing)
- 대칭형 다중 처리
- 다수의 프로세서가 하나의 메모리 영역과 하드웨어 자원들을 공유하는 것

물리 프로세서와 논리 프로세서(코어)
- 2개의 물리 프로세서와 각각이 4개의 논리 프로세서를 가진다면, 8개의 작업을 동시에 처리 가능하다
- 논리 프로세서인 코어마다 작업 스레드를 처리할 수 있다

프로세서 확인
- 작업관리자에서 성능탭에서 확인 가능
   - CPU 그래프를 `논리 프로세서`로 변경
- 값 설명
   - 소켓: 물리적 프로세서 개수
   - 가상 프로세서: 논리적 프로세서 개수
   - 물리 프로세서 > 코어 > 논리 프로세서
- 하이퍼스레딩
   - 윈도우에서 논리적 프로세서 개수는 코어수에 x2로 보인다
   - 이는 인텔의 하이퍼스레딩 기술인데, 1갱 코어에 2개의 스레드를 실행시키는 기술\
   - 인코딩, 디코딩 같은 멀티미디어 작업에만 한정

## 유니코드
윈도우에서 사용하는 대표 문자세트
- 아스키코드 (1바이트)
- 유니코드 (2바이트)


