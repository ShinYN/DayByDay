# 보안그룹과 ACL
## 보안그룹과 ACL
AWS 트래픽 제어 정책
1. Security Group
2. Network Access Control List
- 접근 제어를 보려면 아래 순서로 확인해본다
   1. 네트워크 ACL 인바운드
   2. 보안그룹 인바운드
   3. 보안그룹 아웃바운드
   4. 네트워크 ACL 아웃바운드
- 일반적으로는 보안 그룹을 통해서 필터링하고, IP 대역에서 차단이 필요할 경우 네트워크 ACL을 사용한다.<br>네트워크 ACL은 Statless이기 때문에 인바운드/아웃바운드 규칙설정에 민감해서 잘 사용하지 않는다.

대상 식별
- IP, Port, Protocol

규칙
- 인바운드 규칙: 외부에서 AWS 내부로
- 아웃바운드 규칙: AWS 내부에서 외부로

차이점
- 제어 대상
   - 보안 그룹: 인스턴스 레벨 (예: EC2, ALB)
   - ACL: 서브넷 레벨
- Stateful/Stateless
   - 보안그룹: Stateful
      - 인바운드에 허용된 대상이 아웃바운드로 되돌아 갈때는 아웃바운드 규칙 상관없이 허용된다. (반대 케이스도 동일하게 동작)
   - 네트워크 ACL: Stateless
- 허용/거부 규칙
   - 보안 그룹: 허용 규칙만 존재. 나머지는 자동으로 거부
   - 네트워크 ACL: 허용/거부 존재
      - 각 규칙에는 순서가 있어서 작은 숫자부터 확인하다가 맞는 조건이 있으면 처리
      - 마지막 규칙은 모두 거부

네트워크 ACL 인바운드/아웃바운드 설정
- 네트워크 ACL은 Stateless 하기 때문에 인바운드/아웃바운드 설정을 모두 해주어야한다
- 이때 포트 설정을 잘 해줘야하는데, 인바운드의 클라이언트 포트가 아웃바운드의 타겟 포트가 되기 때문이다. 

## VPC 플로우 로그
개념
- VPC에 속한 네트워크 인터페이스에 송수신 되는 트래픽에 대한 정보를 수집할 수 있는 기능
- 이를 통해서 네트워크 문제를 해결하거나 특정 유형의 트래픽을 감지해서 알람, 통계 지표를 만들 수 있다

대상
- 서브넷의 특정 인스턴스를 대상으로 할 수도 있고, 서브넷 전체를 대상으로 할 수 도 있다
- 출력은 S3나 Cloudwatch Logs로 할 수 있다

